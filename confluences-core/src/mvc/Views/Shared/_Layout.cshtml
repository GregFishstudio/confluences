<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>@ViewData["Title"] - Confluences</title>

    <!-- POLICES + ICONS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <!-- BOOTSTRAP -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>

    <!-- TON CSS MODERNE -->
    <link rel="stylesheet" href="~/css/app-modern.css" />

    <!-- SYNCFUSION -->
    <link rel="stylesheet" href="https://cdn.syncfusion.com/ej2/22.2.5/fluent.css" />
    <script src="https://cdn.syncfusion.com/ej2/22.2.5/dist/ej2.min.js"></script>

    <!-- SIGNALR -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/3.1.11/signalr.min.js"></script>

    <!-- JITSI -->
    <script src='https://meet.jit.si/external_api.js'></script>

    <!-- DATATABLES -->
    <link href="~/css/datatable/jquery.dataTables.min.css" rel="stylesheet" />
</head>


<body>

@{
    bool isTeacher = User.HasClaim("role", "Teacher");
    bool isStudent = User.HasClaim("role", "Student") || isTeacher;
    bool showAll = Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") != "Production";
}

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <img src="~/img/logo_confluences.png" class="sidebar-logo" />
        <span class="sidebar-title">Confluences</span>
    </div>

    <ul class="sidebar-menu">

        <li>
            <a asp-controller="Home" asp-action="Index">
                <span class="material-icons">home</span> <span>Accueil</span>
            </a>
        </li>

        @if (showAll || isTeacher)
        {
            <li class="sidebar-section">Administration</li>
            <li class="nav-item">
                <a class="nav-link" asp-controller="Appointments" asp-action="Index">Les rendez-vous</a>
            </li>
            <li><a asp-controller="SchoolClassRooms" asp-action="Index">
                <span class="material-icons">class</span> <span>Classes</span>
            </a></li>

            <li><a asp-controller="AspNetUsers" asp-action="Index">
                <span class="material-icons">group</span> <span>Utilisateurs</span>
            </a></li>

            <li><a asp-controller="Ressource" asp-action="Homeworks">
                <span class="material-icons">folder</span> <span>Ressources</span>
            </a></li>
        }

        @if (isStudent)
        {
            <li class="sidebar-section">Espace élève</li>

            <li><a asp-controller="StudentPage" asp-action="Index">
                <span class="material-icons">person</span> <span>Ma page</span>
            </a></li>

            <li class="nav-item">
                <a class="nav-link" asp-controller="StudentPage" asp-action="MyAppointments">Mes rendez-vous</a>
            </li>

            <li><a asp-controller="StudentPage" asp-action="PreviousLessons">
                <span class="material-icons">history</span> <span>Leçons précédentes</span>
            </a></li>

            <li><a asp-controller="StudentPage" asp-action="Help">
                <span class="material-icons">help</span> <span>Aide</span>
            </a></li>
        }

        <li class="sidebar-section"></li>

        @if (User.Identity.IsAuthenticated)
        {
            <li><a asp-controller="Account" asp-action="Logout">
                <span class="material-icons">logout</span> <span>Déconnexion</span>
            </a></li>
        }
        else
        {
            <li><a asp-controller="Account" asp-action="SignIn">
                <span class="material-icons">login</span> <span>Se connecter</span>
            </a></li>
        }
    </ul>
</div>


<!-- PAGE -->
<div class="page-container">

    <!-- TOP BAR -->
    <nav class="topbar">
        <button class="menu-toggle" onclick="toggleSidebar()">
            <span class="material-icons">menu</span>
        </button>

        <div class="topbar-title">@ViewData["Title"]</div>

        <div class="topbar-user">
            @if (User.Identity.IsAuthenticated)
            {
                <span class="material-icons">account_circle</span>
                <span>@User.Identity.Name</span>
            }
        </div>
    </nav>

    <!-- CONTENT -->
    <main class="content">
        @RenderBody()
    </main>

</div>


<!-- TOGGLE SIDEBAR -->
<script>
    function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("sidebar-open");
    }
</script>

<!-- Syncfusion script manager -->
<ejs-scripts></ejs-scripts>

<!-- LIB JS -->
<script src="~/js/core/jquery.min.js"></script>
<script src="~/js/core/popper.min.js"></script>
<script src="~/js/core/bootstrap-material-design.min.js"></script>
<script src="~/js/plugins/moment-with-locales.min.js"></script>
<script src="~/js/plugins/bootstrap-datetimepicker.js"></script>
<script src="~/js/plugins/nouislider.min.js"></script>
<script src="~/js/plugins/bootstrap-tagsinput.js"></script>
<script src="~/js/plugins/bootstrap-selectpicker.js"></script>
<script src="~/js/plugins/jasny-bootstrap.min.js"></script>
<script src="~/js/material-kit.js?v=2.2.0"></script>
<script src="~/js/datatable/jquery.dataTables.min.js"></script>
<script src="https://nightly.datatables.net/responsive/js/dataTables.responsive.min.js"></script>

<script src="~/js/site.js"></script>

@RenderSection("Scripts", required: false)

</body>
</html>
