@{
    ViewData["Title"] = "Bienvenue";
    var loginUrl = $"{ViewData["URLIdentityServer4"]}/Account/Login?returnUrl={ViewData["URLClientMVC"]}";
}

<div class="landing-wrapper">
    <div class="hero-section">
        <div class="content">
            <img src="~/img/logo_confluences.png" class="hero-logo" alt="Logo" />

            <h1 class="title">Confluences</h1>
            <p class="subtitle">
                Plateforme interne de gestion des cours, étudiants, stages et activités.
            </p>

            <button class="cta-login" onclick="openLoginModal()">Se connecter</button>
        </div>
    </div>

    <div class="info-section">
        <h2>Bienvenue sur la plateforme</h2>
        <p>
            Connectez-vous pour accéder aux fonctionnalités :
        </p>

        <ul>
            <li>📘 Gestion des cours</li>
            <li>🧑‍🎓 Suivi des étudiants</li>
            <li>📄 Ressources et documents</li>
            <li>📅 Planning et rendez-vous</li>
            <li>📝 Devoirs et exercices</li>
        </ul>
    </div>
</div>
<div id="loginModal" class="modal-overlay" style="display:none;">
    <div class="modal-box">

        <iframe id="loginFrame"
                src=""
                style="width:100%;height:500px;border:none;border-radius:10px;">
        </iframe>

        <button onclick="closeLoginModal()" class="close-btn">Fermer</button>
    </div>
</div>

<script>
function openLoginModal() {
    document.getElementById("loginModal").style.display = "flex";
}

function closeLoginModal() {
    document.getElementById("loginModal").style.display = "none";
}

async function submitLogin() {
    const username = document.getElementById("loginUsername").value;
    const password = document.getElementById("loginPassword").value;
    const errorBox = document.getElementById("loginError");

    const returnUrl = "@ViewData["URLClientMVC"]";

    const response = await fetch("@ViewData["URLIdentityServer4"]/Account/Login", {
        method: "POST",
        credentials: "include",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: new URLSearchParams({
            Username: username,
            Password: password,
            ReturnUrl: returnUrl
        })
    });

    if (response.redirected) {
        window.location.href = response.url;
        return;
    }

    const text = await response.text();
    if (text.includes("invalid") || text.includes("Incorrect")) {
        errorBox.innerText = "Nom d’utilisateur ou mot de passe incorrect";
        errorBox.style.display = "block";
    }
}
</script>

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: "Inter", sans-serif;
        background: #f5f7fb;
    }

    .landing-wrapper {
        width: 100%;
    }

    .hero-section {
        background: linear-gradient(135deg, #4361ee, #7209b7);
        padding: 6rem 2rem;
        text-align: center;
        color: white;
    }

    .hero-logo {
        height: 120px;
        margin-bottom: 1.5rem;
        filter: drop-shadow(0 5px 10px rgba(0,0,0,0.25));
    }

    .title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
    }

    .subtitle {
        max-width: 600px;
        margin: auto;
        opacity: 0.9;
        font-size: 1.2rem;
        margin-bottom: 2rem;
    }

    .cta-login {
        background: white;
        color: #333;
        text-decoration: none;
        padding: 1rem 2rem;
        border-radius: 12px;
        display: inline-block;
        font-size: 1.2rem;
        font-weight: 600;
        transition: 0.22s ease;
    }

    .cta-login:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }

    .info-section {
        background: white;
        padding: 3rem 2rem;
        text-align: center;
        max-width: 900px;
        margin: auto;
        margin-top: -2rem;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    .info-section h2 {
        font-size: 2rem;
        margin-bottom: 1rem;
        color: #333;
        font-weight: 600;
    }

    .info-section ul {
        list-style: none;
        padding: 0;
        margin-top: 1.5rem;
        line-height: 2;
        font-size: 1.1rem;
        color: #444;
    }

    .info-section li {
        margin: 0.4rem 0;
    }

    .modal-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}
.modal-box {
    background: white;
    padding: 1rem;
    border-radius: 12px;
    width: 480px;
}
.close-btn {
    margin-top: 1rem;
    background: #ddd;
}
</style>
